##### Configuration #####
# path to tree for signal and background
treePathSig = ggHiNtuplizer/EventTree
treePathBkg = ggHiNtuplizer/EventTree
# path to friend trees, friends will be added with an alias, 1st friend has alias "t0", 2nd friend has "t1", etc
var.string FRIENDTREES = {skimanalysis/HltTree, hiEvtAnalyzer/HiTree}
treeFriendPathsSig = $FRIENDTREES$
treeFriendPathsBkg = $FRIENDTREES$
# expressions for event dependent weights
var.string WEIGHTPTHATSIG = (15 <= t1.pthat && t1.pthat < 30) * 0.999082 + (30 <= t1.pthat && t1.pthat < 50) * 0.102211 + (50 <= t1.pthat && t1.pthat < 80) * 0.0218972 + (80 <= t1.pthat && t1.pthat < 120) * 0.00460337 + (120 <= t1.pthat && t1.pthat < 999999) * 0.0033236
var.string WEIGHTPTHATBKG = (30 <= t1.pthat && t1.pthat < 50) * 0.99987 + (50 <= t1.pthat && t1.pthat < 80) * 0.430414 + (80 <= t1.pthat && t1.pthat < 120) * 0.195464 + (120 <= t1.pthat && t1.pthat < 170) * 0.0736457 + (170 <= t1.pthat && t1.pthat < 999999) * 0.0226664
weightExpressionSig =
weightExpressionBkg =
var.string BRANCHES = nPho, pho*, nMC, mc*
var.string BRANCHESFRIEND = t0.pcollisionEventSelection, t1.vz, t1.hiBin
var.string ACTIVEBRANCHES = {$BRANCHES$, $BRANCHESFRIEND$}
# branches activated in signal and background trees
treeSigBranches = $ACTIVEBRANCHES$
treeBkgBranches = $ACTIVEBRANCHES$
# branches for spectators
treeSpectatorBranches = {phoEt, phoEta, phoPhi, phoSCEta, phoSCPhi, phoHoverE, pho_ecalClusterIsoR4, pho_hcalRechitIsoR4, pho_trackIsoR4PtCut20, pho_genMatchedIndex}
tmvaFactoryOptions = !V:!Silent:Color=False:DrawProgressBar:AnalysisType=Classification
# TMVA factory methods separated by ";;;".
tmvaMethods = $MLB$ { # <method_type>, <method_title>, <base_options>
                      kCuts, CutsGA, !H:!V:FitMethod=GA:EffMethod=EffSEl ;;;
#                      kCuts, CutsGA_Size800_Steps60, !H:!V:FitMethod=GA:EffMethod=EffSEl:PopSize=800:Steps=60 ;;;
#                      kCuts, CutsSA, !H:!V:FitMethod=SA:EffMethod=EffSel:UseDefaultScale ;;;
#                      kCuts, CutsSA_Calls500K, !H:!V:FitMethod=SA:EffMethod=EffSel:MaxCalls=500000:UseDefaultScale ;;;
#                      kCuts, CutsMC,             !H:!V:FitMethod=MC:EffMethod=EffSel ;;;
#                      kCuts, CutsMC_Size1M,    !H:!V:FitMethod=MC:EffMethod=EffSel:SampleSize=1000000 ;;;
                    } $MLE$
# flags to run Factory methods
runTmvaFactoryTrain = 1
runTmvaFactoryTest = 1
runTmvaFactoryEval = 1
var.string FRACTRAIN = 0.3333333
# fraction of events used in training
fracTrainEvtSig = $FRACTRAIN$
fracTrainEvtBkg = $FRACTRAIN$
var.string SELCOLL = t0.pcollisionEventSelection > 0
var.string SELEVENT = ($SELCOLL$ && abs(t1.vz) < 15)
var.string PTMIN = 40
var.string PTMAX = 999999
var.string SEL_PT = phoEt >= $PTMIN$ && phoEt < $PTMAX$
var.string EXCLUDEHI18HEM = !(phoSCEta < -1.39 && phoSCPhi < -0.9 && phoSCPhi > -1.6)
var.string SEL_EB = abs(phoSCEta) < 1.48 && $EXCLUDEHI18HEM$
var.string SEL_EE = abs(phoSCEta) >= 1.57 && abs(phoSCEta) < 2.4 && $EXCLUDEHI18HEM$
var.string SEL_EE1 = abs(phoSCEta) >= 1.57 && abs(phoSCEta) < 2.0 && $EXCLUDEHI18HEM$
var.string SEL_EE2 = abs(phoSCEta) >= 2.0 && abs(phoSCEta) < 2.4 && $EXCLUDEHI18HEM$
var.string PRESELRECO = $SEL_PT$ && phoSigmaIEtaIEta_2012 < 0.5 && pho_trackIsoR4PtCut20 > -500 && pho_trackIsoR4PtCut20 < 500
var.string PRESELRECO_EB = $PRESELRECO$ && $SEL_EB$
var.string PRESELRECO_EE = $PRESELRECO$ && $SEL_EE$
var.string PRESELRECO_EE1 = $PRESELRECO$ && $SEL_EE1$
var.string PRESELRECO_EE2 = $PRESELRECO$ && $SEL_EE2$
var.string PRESELGENMATCH = pho_genMatchedIndex > -1 && mcPID[pho_genMatchedIndex] == 22
var.string PRESELGENSIG = mcCalIsoDR04[pho_genMatchedIndex] < 5 && (abs(mcMomPID[pho_genMatchedIndex]) <= 22 || mcMomPID[pho_genMatchedIndex] == -999)
var.string PRESELGENBKG = (!($PRESELGENMATCH$) || !($PRESELGENSIG$))
# preselections for signal and background
var.string PRESELSIG_FRAG = $PRESELGENMATCH$ && $PRESELGENSIG$ && $SELEVENT$
var.string PRESELBKG_FRAG = $PRESELGENBKG$ && $SELEVENT$
var.string PRESELSIG_EB = $PRESELRECO_EB$ && $PRESELSIG_FRAG$
var.string PRESELBKG_EB = $PRESELRECO_EB$ && $PRESELBKG_FRAG$
var.string PRESELSIG_EE = $PRESELRECO_EE$ && $PRESELSIG_FRAG$
var.string PRESELBKG_EE = $PRESELRECO_EE$ && $PRESELBKG_FRAG$
var.string PRESELSIG_EE1 = $PRESELRECO_EE1$ && $PRESELSIG_FRAG$
var.string PRESELBKG_EE1 = $PRESELRECO_EE1$ && $PRESELBKG_FRAG$
var.string PRESELSIG_EE2 = $PRESELRECO_EE2$ && $PRESELSIG_FRAG$
var.string PRESELBKG_EE2 = $PRESELRECO_EE2$ && $PRESELBKG_FRAG$
preselectionSig = $PRESELSIG_EB$
preselectionBkg = $PRESELBKG_EB$
# variables used for classification, separated by ";;;"
trainVariables = $MLB$ { # <expression>, <type> (F/I), <VarProp> (NotEnforced/FSmart/FMin/FMax), <CutRangeMin>, <CutRangeMax>;;;
                         phoHoverE, F, FMin, -1, 1;;;
                         phoSigmaIEtaIEta_2012, F, FMin, -1, 0.02;;;
                         sumIso := pho_ecalClusterIsoR4 + pho_hcalRechitIsoR4 + pho_trackIsoR4PtCut20, F, FMin, -400, 50;;;
                       } $MLE$
#####
## EB
var.string HOE_MAX_90EFF_EB = 0.25
var.string SIEIE_MAX_90EFF_EB = 0.013
var.string ISO3_MIN_90EFF_EB = -999999
var.string ISO3_MAX_90EFF_EB = 250
var.string ISO4_MIN_90EFF_EB = -999999
var.string ISO4_MAX_90EFF_EB = 250
## EE
var.string HOE_MAX_90EFF_EE = 0.4
var.string SIEIE_MAX_90EFF_EE = 0.045
var.string ISO3_MIN_90EFF_EE = $ISO3_MIN_90EFF_EB$
var.string ISO3_MAX_90EFF_EE = $ISO3_MAX_90EFF_EB$
var.string ISO4_MIN_90EFF_EE = $ISO4_MIN_90EFF_EB$
var.string ISO4_MAX_90EFF_EE = $ISO4_MAX_90EFF_EB$
#### maximum values for training medium WP
## EB
var.string HOE_MAX_80EFF_EB_TRKCALISO4 = 0.222150
var.string HOE_MAX_80EFF_EB_SUMISO4 = 0.236991
var.string HOE_MAX_80EFF_EB_PFISO4SUBUE = 0.181396
var.string HOE_MAX_80EFF_EB_PFSUMISO4SUBUE = 0.138039
var.string HOE_MAX_80EFF_EB_PFISO4RHOCORR = 0.177874
var.string HOE_MAX_80EFF_EB_PFSUMISO4RHOCORR = 0.132676
var.string SIEIE_MAX_80EFF_EB_TRKCALISO4 = 0.012432
var.string SIEIE_MAX_80EFF_EB_SUMISO4 = 0.010979
var.string SIEIE_MAX_80EFF_EB_PFISO4SUBUE = 0.010981
var.string SIEIE_MAX_80EFF_EB_PFSUMISO4SUBUE = 0.010510
var.string SIEIE_MAX_80EFF_EB_PFISO4RHOCORR = 0.010995
var.string SIEIE_MAX_80EFF_EB_PFSUMISO4RHOCORR = 0.010614
var.string ISO3_MIN_80EFF_EB = -999999
var.string ISO3_MAX_80EFF_EB = 200
var.string ISO4_MIN_80EFF_EB = -999999
var.string TRKISO4_MAX_80EFF_EB = 10.630214
var.string ECALISO4_MAX_80EFF_EB = 12.470950
var.string HCALISO4_MAX_80EFF_EB = 243.538938
var.string SUMISO4_MAX_80EFF_EB = 20.168663
var.string PFCISO4SUBUE_MAX_80EFF_EB = 16.015641
var.string PFPISO4SUBUE_MAX_80EFF_EB = 141.962226
var.string PFNISO4SUBUE_MAX_80EFF_EB = 242.440104
var.string PFSUMISO4SUBUE_MAX_80EFF_EB = 192.694518
var.string PFCISO4RHOCORR_MAX_80EFF_EB = 18.383459
var.string PFPISO4RHOCORR_MAX_80EFF_EB = 161.158696
var.string PFNISO4RHOCORR_MAX_80EFF_EB = 119.739628
var.string PFSUMISO4RHOCORR_MAX_80EFF_EB = 235.401023
## EE
var.string HOE_MAX_80EFF_EE_TRKCALISO4 = 0.381004
var.string HOE_MAX_80EFF_EE_SUMISO4 = 0.349191
var.string HOE_MAX_80EFF_EE_PFISO4SUBUE = 0.260072
var.string HOE_MAX_80EFF_EE_PFSUMISO4SUBUE = 0.244406
var.string HOE_MAX_80EFF_EE_PFISO4RHOCORR = 0.281815
var.string HOE_MAX_80EFF_EE_PFSUMISO4RHOCORR = 0.239850
var.string SIEIE_MAX_80EFF_EE_TRKCALISO4 = 0.044723
var.string SIEIE_MAX_80EFF_EE_SUMISO4 = 0.044400
var.string SIEIE_MAX_80EFF_EE_PFISO4SUBUE = 0.037247
var.string SIEIE_MAX_80EFF_EE_PFSUMISO4SUBUE = 0.033978
var.string SIEIE_MAX_80EFF_EE_PFISO4RHOCORR = 0.036674
var.string SIEIE_MAX_80EFF_EE_PFSUMISO4RHOCORR = 0.034227
var.string ISO3_MIN_80EFF_EE = -999999
var.string ISO3_MAX_80EFF_EE = 200
var.string ISO4_MIN_80EFF_EE = -999999
var.string TRKISO4_MAX_80EFF_EE = 14.716313
var.string ECALISO4_MAX_80EFF_EE = 35.885441
var.string HCALISO4_MAX_80EFF_EE = 104.516230
var.string SUMISO4_MAX_80EFF_EE = 28.013417
var.string PFCISO4SUBUE_MAX_80EFF_EE = 14.201033
var.string PFPISO4SUBUE_MAX_80EFF_EE = 183.130604
var.string PFNISO4SUBUE_MAX_80EFF_EE = 40.092190
var.string PFSUMISO4SUBUE_MAX_80EFF_EE = 204.281222
var.string PFCISO4RHOCORR_MAX_80EFF_EE = 18.311696
var.string PFPISO4RHOCORR_MAX_80EFF_EE = 101.820401
var.string PFNISO4RHOCORR_MAX_80EFF_EE = 40.262956
var.string PFSUMISO4RHOCORR_MAX_80EFF_EE = 150.883121
#### maximum values for training tight WP
## EB
var.string HOE_MAX_70EFF_EB_TRKCALISO4 = 0.197374
var.string HOE_MAX_70EFF_EB_SUMISO4 = 0.189417
var.string HOE_MAX_70EFF_EB_PFISO4SUBUE = 0.130977
var.string HOE_MAX_70EFF_EB_PFSUMISO4SUBUE = 0.136594
var.string HOE_MAX_70EFF_EB_PFISO4RHOCORR = 0.164445
var.string HOE_MAX_70EFF_EB_PFSUMISO4RHOCORR = 0.130805
var.string SIEIE_MAX_70EFF_EB_TRKCALISO4 = 0.010981
var.string SIEIE_MAX_70EFF_EB_SUMISO4 = 0.010949
var.string SIEIE_MAX_70EFF_EB_PFISO4SUBUE = 0.010238
var.string SIEIE_MAX_70EFF_EB_PFSUMISO4SUBUE = 0.010487
var.string SIEIE_MAX_70EFF_EB_PFISO4RHOCORR = 0.010287
var.string SIEIE_MAX_70EFF_EB_PFSUMISO4RHOCORR = 0.010561
var.string ISO3_MIN_70EFF_EB = -999999
var.string ISO3_MAX_70EFF_EB = 200
var.string ISO4_MIN_70EFF_EB = -999999
var.string TRKISO4_MAX_70EFF_EB = 6.231674
var.string ECALISO4_MAX_70EFF_EB = 9.558521
var.string HCALISO4_MAX_70EFF_EB = 197.442329
var.string SUMISO4_MAX_70EFF_EB = 9.473923
var.string PFCISO4SUBUE_MAX_70EFF_EB = 12.898142
var.string PFPISO4SUBUE_MAX_70EFF_EB = 133.887671
var.string PFNISO4SUBUE_MAX_70EFF_EB = 49.652577
var.string PFSUMISO4SUBUE_MAX_70EFF_EB = 21.997385
var.string PFCISO4RHOCORR_MAX_70EFF_EB = 12.973759
var.string PFPISO4RHOCORR_MAX_70EFF_EB = 161.034744
var.string PFNISO4RHOCORR_MAX_70EFF_EB = 114.369897
var.string PFSUMISO4RHOCORR_MAX_70EFF_EB = 20.293277
## EE
var.string HOE_MAX_70EFF_EE_TRKCALISO4 = 0.324757
var.string HOE_MAX_70EFF_EE_SUMISO4 = 0.320943
var.string HOE_MAX_70EFF_EE_PFISO4SUBUE = 0.255913
var.string HOE_MAX_70EFF_EE_PFSUMISO4SUBUE = 0.214513
var.string HOE_MAX_70EFF_EE_PFISO4RHOCORR = 0.237537
var.string HOE_MAX_70EFF_EE_PFSUMISO4RHOCORR = 0.239072
var.string SIEIE_MAX_70EFF_EE_TRKCALISO4 = 0.044400
var.string SIEIE_MAX_70EFF_EE_SUMISO4 = 0.044236
var.string SIEIE_MAX_70EFF_EE_PFISO4SUBUE = 0.032230
var.string SIEIE_MAX_70EFF_EE_PFSUMISO4SUBUE = 0.030208
var.string SIEIE_MAX_70EFF_EE_PFISO4RHOCORR = 0.032448
var.string SIEIE_MAX_70EFF_EE_PFSUMISO4RHOCORR = 0.033254
var.string ISO3_MIN_70EFF_EE = -999999
var.string ISO3_MAX_70EFF_EE = 200
var.string ISO4_MIN_70EFF_EE = -999999
var.string TRKISO4_MAX_70EFF_EE = 6.598621
var.string ECALISO4_MAX_70EFF_EE = 27.713593
var.string HCALISO4_MAX_70EFF_EE = 23.860720
var.string SUMISO4_MAX_70EFF_EE = 17.428985
var.string PFCISO4SUBUE_MAX_70EFF_EE = 10.518733
var.string PFPISO4SUBUE_MAX_70EFF_EE = 163.180214
var.string PFNISO4SUBUE_MAX_70EFF_EE = 34.845394
var.string PFSUMISO4SUBUE_MAX_70EFF_EE = 149.652424
var.string PFCISO4RHOCORR_MAX_70EFF_EE = 15.714592
var.string PFPISO4RHOCORR_MAX_70EFF_EE = 100.366419
var.string PFNISO4RHOCORR_MAX_70EFF_EE = 30.541919
var.string PFSUMISO4RHOCORR_MAX_70EFF_EE = 23.398543
#### maximum values for training extratight WP
## EB
var.string HOE_MAX_60EFF_EB_TRKCALISO4 = 0.183248
var.string HOE_MAX_60EFF_EB_SUMISO4 = 0.126288
var.string HOE_MAX_60EFF_EB_PFISO4SUBUE = 0.129690
var.string HOE_MAX_60EFF_EB_PFSUMISO4SUBUE = 0.130897
var.string HOE_MAX_60EFF_EB_PFISO4RHOCORR = 0.132404
var.string HOE_MAX_60EFF_EB_PFSUMISO4RHOCORR = 0.112572
var.string SIEIE_MAX_60EFF_EB_TRKCALISO4 = 0.010454
var.string SIEIE_MAX_60EFF_EB_SUMISO4 = 0.010241
var.string SIEIE_MAX_60EFF_EB_PFISO4SUBUE = 0.010169
var.string SIEIE_MAX_60EFF_EB_PFSUMISO4SUBUE = 0.010454
var.string SIEIE_MAX_60EFF_EB_PFISO4RHOCORR = 0.010076
var.string SIEIE_MAX_60EFF_EB_PFSUMISO4RHOCORR = 0.010222
var.string ISO3_MIN_60EFF_EB = -999999
var.string ISO3_MAX_60EFF_EB = 200
var.string ISO4_MIN_60EFF_EB = -999999
var.string TRKISO4_MAX_60EFF_EB = 4.407591
var.string ECALISO4_MAX_60EFF_EB = 4.662295
var.string HCALISO4_MAX_60EFF_EB = 117.683292
var.string SUMISO4_MAX_60EFF_EB = 6.368348
var.string PFCISO4SUBUE_MAX_60EFF_EB = 10.692230
var.string PFPISO4SUBUE_MAX_60EFF_EB = 9.286096
var.string PFNISO4SUBUE_MAX_60EFF_EB = 24.767564
var.string PFSUMISO4SUBUE_MAX_60EFF_EB = 10.124405
var.string PFCISO4RHOCORR_MAX_60EFF_EB = 12.223727
var.string PFPISO4RHOCORR_MAX_60EFF_EB = 1.154920
var.string PFNISO4RHOCORR_MAX_60EFF_EB = 14.688976
var.string PFSUMISO4RHOCORR_MAX_60EFF_EB = 12.315192
## EE
var.string HOE_MAX_60EFF_EE_TRKCALISO4 = 0.310233
var.string HOE_MAX_60EFF_EE_SUMISO4 = 0.383602
var.string HOE_MAX_60EFF_EE_PFISO4SUBUE = 0.230111
var.string HOE_MAX_60EFF_EE_PFSUMISO4SUBUE = 
var.string HOE_MAX_60EFF_EE_PFISO4RHOCORR = 0.219102
var.string HOE_MAX_60EFF_EE_PFSUMISO4RHOCORR = 0.220207
var.string SIEIE_MAX_60EFF_EE_TRKCALISO4 = 0.031229
var.string SIEIE_MAX_60EFF_EE_SUMISO4 = 0.030058
var.string SIEIE_MAX_60EFF_EE_PFISO4SUBUE = 0.030082
var.string SIEIE_MAX_60EFF_EE_PFSUMISO4SUBUE = 
var.string SIEIE_MAX_60EFF_EE_PFISO4RHOCORR = 0.029049
var.string SIEIE_MAX_60EFF_EE_PFSUMISO4RHOCORR = 0.031377
var.string ISO3_MIN_60EFF_EE = -999999
var.string ISO3_MAX_60EFF_EE = 200
var.string ISO4_MIN_60EFF_EE = -999999
var.string TRKISO4_MAX_60EFF_EE = 6.506193
var.string ECALISO4_MAX_60EFF_EE = 22.770000
var.string HCALISO4_MAX_60EFF_EE = 18.609095
var.string SUMISO4_MAX_60EFF_EE = 17.946904
var.string PFCISO4SUBUE_MAX_60EFF_EE = 7.453987
var.string PFPISO4SUBUE_MAX_60EFF_EE = 147.370226
var.string PFNISO4SUBUE_MAX_60EFF_EE = 37.321812
var.string PFSUMISO4SUBUE_MAX_60EFF_EE = 
var.string PFCISO4RHOCORR_MAX_60EFF_EE = 13.840924
var.string PFPISO4RHOCORR_MAX_60EFF_EE = 103.923828
var.string PFNISO4RHOCORR_MAX_60EFF_EE = 38.569287
var.string PFSUMISO4RHOCORR_MAX_60EFF_EE = 16.033904
#CONFIG-END#
